[tox]
minversion = 4.30.2
envlist = py313, mypy, ruff, pyright
isolated_build = true

[gh-actions]
python =
    3.13: py313, mypy, ruff, pyright

[testenv]
basepython = python3.13
extras = test
setenv =
    PIP_NO_CACHE_DIR = 1
commands_pre =
    python -m pip install --upgrade pip
    # Install CPU-only torch first; your package depends on torch, so this satisfies it
    python -m pip install --only-binary=:all: --index-url https://download.pytorch.org/whl/cpu torch
commands =
    pytest {posargs}


[testenv:py313]
# Inherits from [testenv] by default
# Only add here if you need py313-specific config
basepython = python3.13


[testenv:mypy]
basepython = python3.13
description = Run type checking with mypy
extras =
    test
    dev
commands =
    mypy src/coral {posargs}


[testenv:ruff]
basepython = python3.13
description = Run linting and formatting checks with ruff
extras =
    test
    dev
commands =
    ruff check src tests {posargs}
    ruff format --check src tests {posargs}





[testenv:pyright]
description = Run type checking with pyright
extras =
    test
    dev
commands =
    pyright src/coral {posargs}
